-- Criação da tabela Cidades
CREATE TABLE Cidades (
    CidadeID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Nome VARCHAR2(255) NOT NULL,
    Estado VARCHAR2(50),
    Pais VARCHAR2(100),
    PRIMARY KEY (CidadeID)
);

-- Criação da tabela Aeroportos
CREATE TABLE Aeroportos (
    AeroportoID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Nome VARCHAR2(255) NOT NULL,
    CidadeID NUMBER NOT NULL,
    PRIMARY KEY (AeroportoID),
    FOREIGN KEY (CidadeID) REFERENCES Cidades(CidadeID)
);

-- Criação da tabela Aeronaves
CREATE TABLE Aeronaves (
    AeronaveID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Modelo VARCHAR2(255) NOT NULL,
    NumeroIdentificacao VARCHAR2(255) NOT NULL UNIQUE,
    Fabricante VARCHAR2(255) NOT NULL,
    AnoFabricacao NUMBER NOT NULL,
    PRIMARY KEY (AeronaveID)
);

-- Criação da tabela Trechos
CREATE TABLE Trechos (
    TrechoID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    OrigemID NUMBER NOT NULL,
    DestinoID NUMBER NOT NULL,
    OperaIda CHAR(1) CHECK (OperaIda IN ('Y','N')) NOT NULL,
    OperaVolta CHAR(1) CHECK (OperaVolta IN ('Y','N')) NOT NULL,
    PRIMARY KEY (TrechoID),
    FOREIGN KEY (OrigemID) REFERENCES Aeroportos(AeroportoID),
    FOREIGN KEY (DestinoID) REFERENCES Aeroportos(AeroportoID)
);

-- Criação da tabela Voos
CREATE TABLE Voos (
    VooID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    AeronaveID NUMBER NOT NULL,
    TrechoID NUMBER NOT NULL,
    DataHoraPartida TIMESTAMP NOT NULL,
    DataHoraChegada TIMESTAMP NOT NULL,
    ValorAssento NUMBER NOT NULL,
    PRIMARY KEY (VooID),
    FOREIGN KEY (AeronaveID) REFERENCES Aeronaves(AeronaveID),
    FOREIGN KEY (TrechoID) REFERENCES Trechos(TrechoID)
);

-- Criação da tabela Assentos
CREATE TABLE Assentos (
    AssentoID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    AeronaveID NUMBER NOT NULL,
    CodigoAssento VARCHAR2(5) NOT NULL,
    Classe VARCHAR2(50),
    PRIMARY KEY (AssentoID),
    FOREIGN KEY (AeronaveID) REFERENCES Aeronaves(AeronaveID)
);

-- Criação da tabela Clientes
CREATE TABLE Clientes (
    ClienteID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    Nome VARCHAR2(255) NOT NULL,
    Email VARCHAR2(255) NOT NULL UNIQUE,
    PRIMARY KEY (ClienteID)
);

-- Criação da tabela Reservas
CREATE TABLE Reservas (
    ReservaID NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    VooID NUMBER NOT NULL,
    ClienteID NUMBER NOT NULL,
    AssentoID NUMBER NOT NULL,
    Status VARCHAR2(50) NOT NULL,
    PRIMARY KEY (ReservaID),
    FOREIGN KEY (VooID) REFERENCES Voos(VooID),
    FOREIGN KEY (ClienteID) REFERENCES Clientes(ClienteID),
    FOREIGN KEY (AssentoID) REFERENCES Assentos(AssentoID)
);

DROP TABLE CIDADES;

DELETE FROM CIDADES WHERE ID = 11;

SELECT CONSTRAINT_NAME
FROM USER_CONSTRAINTS
WHERE TABLE_NAME = 'AEROPORTOS' AND CONSTRAINT_TYPE = 'R';

ALTER TABLE Aeroportos DROP CONSTRAINT SYS_C008326;

ALTER TABLE Aeroportos
ADD CONSTRAINT fk_aeroportos_cidades
FOREIGN KEY (CidadeID)
REFERENCES Cidades(CidadeID)
ON DELETE CASCADE;

ALTER TABLE Cidades ADD País VARCHAR2(100);

ALTER TABLE Cidades RENAME COLUMN País TO Pais;

DROP TABLE CIDADES;